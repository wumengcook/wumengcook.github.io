window.__require=function t(e,o,i){function n(c,a){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}}var p=o[c]={exports:{}};e[c][0].call(p.exports,function(t){return n(e[c][1][t]||t)},p,p.exports,t,e,o,i)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<i.length;c++)n(i[c]);return n}({Block:[function(t,e,o){"use strict";cc._RF.push(e,"08543LfZ1NOQZ1UStgGS/Or","Block"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,r=(i.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(t,e,o,i){var n=this;this.scheduleOnce(function(){var o=cc.moveBy(t,cc.v2(0,-e));n.node.runAction(o),i()},o)},e.prototype.destroyBlock=function(t,e,o){var i=cc.moveBy(t,cc.v2(0,-e));this.node.runAction(i)},e=__decorate([n],e)}(cc.Component));o.Block=r,cc._RF.pop()},{}],Game:[function(t,e,o){"use strict";cc._RF.push(e,"0c6d2dAtRdGO5hQ1DH49nVO","Game"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Stage"),n=t("./OverPanel"),r=cc._decorator,c=r.ccclass,a=r.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stage=null,e.scoreLabel=null,e.oneButton=null,e.twoButton=null,e.threeButton=null,e.overPanel=null,e}var o;return __extends(e,t),o=e,e.prototype.start=function(){this.overPanel.init(this),this.overPanel.hide(),this.startGame(),this.addListeners()},e.prototype.handleStep=function(t){this.stage.playerJump(t)},e.prototype.addScore=function(t){this.score+=t,this.scoreLabel.string=this.score+""},e.prototype.startGame=function(){this.score=0,this.scoreLabel.node.active=!0,this.scoreLabel.string="0",this.stage.init(this)},e.prototype.overGame=function(){cc.log("over"),this.scoreLabel.node.active=!1,this.score>o.maxscore&&(o.maxscore=this.score),this.overPanel.show(this.score,o.maxscore)},e.prototype.onBtnOne=function(){this.handleStep(1)},e.prototype.onBtnTwo=function(){this.handleStep(2)},e.prototype.onBtnThree=function(){this.handleStep(3)},e.prototype.addListeners=function(){var t=this;this.oneButton.on(cc.Node.EventType.TOUCH_END,this.onBtnOne,this),this.twoButton.on(cc.Node.EventType.TOUCH_END,this.onBtnTwo,this),this.threeButton.on(cc.Node.EventType.TOUCH_END,this.onBtnThree,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,function(e){e.keyCode===cc.macro.KEY.left?t.handleStep(1):e.keyCode===cc.macro.KEY.right?t.handleStep(2):e.keyCode===cc.macro.KEY.up&&t.handleStep(3)},this)},e.prototype.removeListeners=function(){},e.maxscore=0,__decorate([a(i.Stage)],e.prototype,"stage",void 0),__decorate([a(cc.Label)],e.prototype,"scoreLabel",void 0),__decorate([a(cc.Node)],e.prototype,"oneButton",void 0),__decorate([a(cc.Node)],e.prototype,"twoButton",void 0),__decorate([a(cc.Node)],e.prototype,"threeButton",void 0),__decorate([a(n.OverPanel)],e.prototype,"overPanel",void 0),e=o=__decorate([c],e)}(cc.Component);o.Game=s,cc._RF.pop()},{"./OverPanel":"OverPanel","./Stage":"Stage"}],OverPanel:[function(t,e,o){"use strict";cc._RF.push(e,"9a389SLZb5MBJMUKkVwuNVs","OverPanel"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,r=i.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scoreLabel=null,e.maxscoreLabel=null,e.restartButton=null,e}return __extends(e,t),e.prototype.init=function(t){var e=this;this.game=t,this.restartButton.on(cc.Node.EventType.TOUCH_END,function(){e.hide(),cc.director.loadScene("game")},this)},e.prototype.show=function(t,e){this.maxscoreLabel.string=e+"",this.scoreLabel.string=t+"",this.node.active=!0},e.prototype.hide=function(){this.node.active=!1},__decorate([r(cc.Label)],e.prototype,"scoreLabel",void 0),__decorate([r(cc.Label)],e.prototype,"maxscoreLabel",void 0),__decorate([r(cc.Node)],e.prototype,"restartButton",void 0),e=__decorate([n],e)}(cc.Component);o.OverPanel=c,cc._RF.pop()},{}],Player:[function(t,e,o){"use strict";cc._RF.push(e,"2dd3aTbuNdI04zLB/5zr8NQ","Player"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,n=i.ccclass,r=(i.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(t,e,o,i,n){this.jumpDistance=t,this.jumpHeight=e,this.jumpDuration=o,this.fallDuration=i,this.fallHeight=n,this.index=0,this.canJump=!0},e.prototype.jump=function(t){var e=this;this.canJump=!1,this.index+=t;var o=cc.jumpBy(this.jumpDuration,cc.v2(t*this.jumpDistance,0),this.jumpHeight,1),i=cc.callFunc(function(){e.canJump=!0});this.node.runAction(cc.sequence(o,i))},e.prototype.die=function(){this.canJump=!1;var t=cc.moveBy(this.fallDuration,cc.v2(0,-this.fallHeight));this.node.runAction(t)},e=__decorate([n],e)}(cc.Component));o.Player=r,cc._RF.pop()},{}],Stage:[function(t,e,o){"use strict";cc._RF.push(e,"954a1JEfzZP+rRzRGON1TY6","Stage"),Object.defineProperty(o,"__esModule",{value:!0});var i=t("./Player"),n=t("./Block"),r=cc._decorator,c=r.ccclass,a=r.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stepDistance=200,e.jumpHeight=100,e.jumpDuration=.3,e.fallHeight=500,e.fallDuration=.3,e.initStayDuration=2,e.minStayDuration=.3,e.speed=.1,e.blockPrefab=null,e.blockLayer=null,e.player=null,e.lastBlock=!1,e.lastBlockX=0,e.gameBlankNumber=0,e.gameNumber=3,e}return __extends(e,t),e.prototype.init=function(t){this.game=t,this.stayDuration=this.initStayDuration,this.player.init(this.stepDistance,this.jumpHeight,this.jumpDuration,this.fallDuration,this.fallHeight),this.blockList=[],this.addBlock(cc.v2(0,0));for(var e=0;e<5;e++)this.randomAddBlock()},e.prototype.addSpeed=function(){this.stayDuration-=this.speed,this.stayDuration<=this.minStayDuration&&(this.stayDuration=this.minStayDuration),cc.log(this.stayDuration)},e.prototype.playerJump=function(t){var e=this;if(this.player.canJump){if(this.player.jump(t),this.moveStage(t),this.AddStage(t),this.destroyJumpBlock(t),!this.hasBlock(this.player.index))cc.log("die"),this.scheduleOnce(function(){e.player.die(),e.game.overGame()},this.jumpDuration);else{var o=this.player.index;this.blockList[o].init(this.fallDuration,this.fallHeight,this.stayDuration,function(){e.player.index===o&&(e.player.die(),e.game.overGame())}),this.game.addScore(1===t?1:2===t?2:3)}this.player.index%10==0&&this.addSpeed()}},e.prototype.moveStage=function(t){var e=cc.moveBy(this.jumpDuration,cc.v2(-this.stepDistance*t,0));this.blockLayer.runAction(e)},e.prototype.destroyJumpBlock=function(t){for(var e=t;e>0;e--){!this.hasBlock(this.player.index-e)||this.hasBlock(this.player.index-e).destroyBlock(this.fallDuration,this.fallHeight,this.stayDuration)}},e.prototype.AddStage=function(t){for(var e=0;e<t;e++)this.randomAddBlock()},e.prototype.randomAddBlock=function(){this.lastBlock||Math.random()>.5?this.addBlock(cc.v2(this.lastBlockX+this.stepDistance,0)):this.addBlank(),this.lastBlockX=this.lastBlockX+this.stepDistance},e.prototype.addBlock=function(t){var e=cc.instantiate(this.blockPrefab);this.blockLayer.addChild(e),e.position=t,this.blockList.push(e.getComponent(n.Block)),this.lastBlock=!1},e.prototype.addBlank=function(){this.blockList.push(null),this.gameBlankNumber=this.gameBlankNumber+1,this.gameBlankNumber%this.gameNumber==2?(this.lastBlock=!0,this.gameBlankNumber=0):this.lastBlock=!1},e.prototype.hasBlock=function(t){return this.blockList[t]},__decorate([a(cc.Integer)],e.prototype,"stepDistance",void 0),__decorate([a(cc.Integer)],e.prototype,"jumpHeight",void 0),__decorate([a(cc.Float)],e.prototype,"jumpDuration",void 0),__decorate([a(cc.Integer)],e.prototype,"fallHeight",void 0),__decorate([a(cc.Float)],e.prototype,"fallDuration",void 0),__decorate([a(cc.Float)],e.prototype,"initStayDuration",void 0),__decorate([a(cc.Float)],e.prototype,"minStayDuration",void 0),__decorate([a(cc.Float)],e.prototype,"speed",void 0),__decorate([a(cc.Prefab)],e.prototype,"blockPrefab",void 0),__decorate([a(cc.Node)],e.prototype,"blockLayer",void 0),__decorate([a(i.Player)],e.prototype,"player",void 0),e=__decorate([c],e)}(cc.Component);o.Stage=s,cc._RF.pop()},{"./Block":"Block","./Player":"Player"}]},{},["Block","Game","OverPanel","Player","Stage"]);